<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>API documentation &mdash; Marvin 0.1.0 documentation</title>
    
    <link rel="stylesheet" href="_static/flasky.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Marvin 0.1.0 documentation" href="index.html" />
    <link rel="prev" title="External API" href="api.html" />
   
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9">

  </head>
  <body>
  
  

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="api.html" title="External API"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Marvin 0.1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="api-documentation">
<h1>API documentation<a class="headerlink" href="#api-documentation" title="Permalink to this headline">¶</a></h1>
<p>This is the documentation for all classes, modules and functions/methods you find in marvin.</p>
<span class="target" id="module-marvin"></span><div class="section" id="marvin">
<h2>marvin<a class="headerlink" href="#marvin" title="Permalink to this headline">¶</a></h2>
<p>This is the main entry point to marvin, the API endpoints for streamr.</p>
<dl class="function">
<dt id="marvin.create_app">
<tt class="descclassname">marvin.</tt><tt class="descname">create_app</tt><big>(</big><em>config_file=None</em>, <em>**extra_config</em><big>)</big><a class="headerlink" href="#marvin.create_app" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a WSGI app.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>config_file</strong> &#8211; Load config from this file.</li>
<li><strong>extra_config</strong> &#8211; Extra configuration values to pass to the WSGI object.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="marvin.make_celery">
<tt class="descclassname">marvin.</tt><tt class="descname">make_celery</tt><big>(</big><big>)</big><a class="headerlink" href="#marvin.make_celery" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a celery object.</p>
<p>Requires that create_app() can be called without arguments, so MARVIN_CONFIG_FILE should
probably point to the config file you want to use.</p>
</dd></dl>

</div>
<span class="target" id="module-marvin.fields"></span><div class="section" id="marvin-fields">
<h2>marvin.fields<a class="headerlink" href="#marvin-fields" title="Permalink to this headline">¶</a></h2>
<p>Some custom form field types used by marvin.</p>
<dl class="class">
<dt id="marvin.fields.JSONField">
<em class="property">class </em><tt class="descclassname">marvin.fields.</tt><tt class="descname">JSONField</tt><big>(</big><em>label=None</em>, <em>validators=None</em>, <em>filters=()</em>, <em>description=u''</em>, <em>id=None</em>, <em>default=None</em>, <em>widget=None</em>, <em>_form=None</em>, <em>_name=None</em>, <em>_prefix=u''</em>, <em>_translations=None</em><big>)</big><a class="headerlink" href="#marvin.fields.JSONField" title="Permalink to this definition">¶</a></dt>
<dd><p>A field that validates and processes JSON input.</p>
</dd></dl>

</div>
<span class="target" id="module-marvin.management"></span><div class="section" id="marvin-management">
<h2>marvin.management<a class="headerlink" href="#marvin-management" title="Permalink to this headline">¶</a></h2>
<p>Configures the manager, and acts as an entry point for the manage command.</p>
<dl class="function">
<dt id="marvin.management.delete_streams_and_entries">
<tt class="descclassname">marvin.management.</tt><tt class="descname">delete_streams_and_entries</tt><big>(</big><em>wipe_movies=False</em><big>)</big><a class="headerlink" href="#marvin.management.delete_streams_and_entries" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete all streams and entries.</p>
<p>After deletion it will reset movie stream counts to 0. Can optionally also
delete all movies, if the &#8211;wipe_movies flag is used.</p>
</dd></dl>

<dl class="function">
<dt id="marvin.management.init_db">
<tt class="descclassname">marvin.management.</tt><tt class="descname">init_db</tt><big>(</big><big>)</big><a class="headerlink" href="#marvin.management.init_db" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the database. Will not migrate if one already exists.</p>
</dd></dl>

<dl class="function">
<dt id="marvin.management.main">
<tt class="descclassname">marvin.management.</tt><tt class="descname">main</tt><big>(</big><big>)</big><a class="headerlink" href="#marvin.management.main" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs the manager.</p>
<p>Target for setup.py entry point.</p>
</dd></dl>

<dl class="function">
<dt id="marvin.management.runserver">
<tt class="descclassname">marvin.management.</tt><tt class="descname">runserver</tt><big>(</big><big>)</big><a class="headerlink" href="#marvin.management.runserver" title="Permalink to this definition">¶</a></dt>
<dd><p>Start a devserver on port 5000</p>
</dd></dl>

</div>
<span class="target" id="module-marvin.models"></span><div class="section" id="marvin-models">
<h2>marvin.models<a class="headerlink" href="#marvin-models" title="Permalink to this headline">¶</a></h2>
<p>Here we define the models we use in marvin. If this module grows too large,
make it a package and split it up into smaller pieces.</p>
<dl class="class">
<dt id="marvin.models.AnonymousUser">
<em class="property">class </em><tt class="descclassname">marvin.models.</tt><tt class="descname">AnonymousUser</tt><a class="headerlink" href="#marvin.models.AnonymousUser" title="Permalink to this definition">¶</a></dt>
<dd><p>Represents an anonymous user.</p>
<dl class="method">
<dt id="marvin.models.AnonymousUser.is_authenticated">
<tt class="descname">is_authenticated</tt><big>(</big><big>)</big><a class="headerlink" href="#marvin.models.AnonymousUser.is_authenticated" title="Permalink to this definition">¶</a></dt>
<dd><p>Used to tell anonymous users apart from authenticated users. Always returns False.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="marvin.models.Entry">
<em class="property">class </em><tt class="descclassname">marvin.models.</tt><tt class="descname">Entry</tt><big>(</big><em>stream=None</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#marvin.models.Entry" title="Permalink to this definition">¶</a></dt>
<dd><p>User-created content that appears at a given time in the movie.</p>
<dl class="attribute">
<dt id="marvin.models.Entry.content">
<tt class="descname">content</tt><a class="headerlink" href="#marvin.models.Entry.content" title="Permalink to this definition">¶</a></dt>
<dd><p>The content of the entry, as a JSON data structure</p>
</dd></dl>

<dl class="attribute">
<dt id="marvin.models.Entry.content_type">
<tt class="descname">content_type</tt><a class="headerlink" href="#marvin.models.Entry.content_type" title="Permalink to this definition">¶</a></dt>
<dd><p>The type of content, e.g. &#8216;text&#8217;, &#8216;wiki&#8217;, &#8216;imdb:actor&#8217;, etc.</p>
</dd></dl>

<dl class="attribute">
<dt id="marvin.models.Entry.entry_point_in_ms">
<tt class="descname">entry_point_in_ms</tt><a class="headerlink" href="#marvin.models.Entry.entry_point_in_ms" title="Permalink to this definition">¶</a></dt>
<dd><p>The time this entry should appear, in ms since the beginning of the stream</p>
</dd></dl>

<dl class="attribute">
<dt id="marvin.models.Entry.id">
<tt class="descname">id</tt><a class="headerlink" href="#marvin.models.Entry.id" title="Permalink to this definition">¶</a></dt>
<dd><p>Unique identifier</p>
</dd></dl>

<dl class="attribute">
<dt id="marvin.models.Entry.stream">
<tt class="descname">stream</tt><a class="headerlink" href="#marvin.models.Entry.stream" title="Permalink to this definition">¶</a></dt>
<dd><p>The stream this entry belongs to</p>
</dd></dl>

<dl class="attribute">
<dt id="marvin.models.Entry.stream_id">
<tt class="descname">stream_id</tt><a class="headerlink" href="#marvin.models.Entry.stream_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Foreign key to a stream</p>
</dd></dl>

<dl class="attribute">
<dt id="marvin.models.Entry.title">
<tt class="descname">title</tt><a class="headerlink" href="#marvin.models.Entry.title" title="Permalink to this definition">¶</a></dt>
<dd><p>The title of the entry</p>
</dd></dl>

<dl class="method">
<dt id="marvin.models.Entry.to_json">
<tt class="descname">to_json</tt><big>(</big><big>)</big><a class="headerlink" href="#marvin.models.Entry.to_json" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a dict representation of the entry suitable for serialization.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="marvin.models.EntryForm">
<em class="property">class </em><tt class="descclassname">marvin.models.</tt><tt class="descname">EntryForm</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#marvin.models.EntryForm" title="Permalink to this definition">¶</a></dt>
<dd><p>Form used to validate new entries.</p>
</dd></dl>

<dl class="class">
<dt id="marvin.models.Movie">
<em class="property">class </em><tt class="descclassname">marvin.models.</tt><tt class="descname">Movie</tt><big>(</big><em>**kwargs</em><big>)</big><a class="headerlink" href="#marvin.models.Movie" title="Permalink to this definition">¶</a></dt>
<dd><p>Movies are the first thing the user will search for.</p>
<p>Through a movie the user can find streams related to this movie.
Most metadata should be fetched automatically from IMDb/TMDB.</p>
<dl class="attribute">
<dt id="marvin.models.Movie.category">
<tt class="descname">category</tt><a class="headerlink" href="#marvin.models.Movie.category" title="Permalink to this definition">¶</a></dt>
<dd><p>What kind of movie is this? E.g. actual movie, episode, clip found on internet?</p>
</dd></dl>

<dl class="attribute">
<dt id="marvin.models.Movie.cover_img">
<tt class="descname">cover_img</tt><a class="headerlink" href="#marvin.models.Movie.cover_img" title="Permalink to this definition">¶</a></dt>
<dd><p>Small cover art, 300px-ish</p>
</dd></dl>

<dl class="attribute">
<dt id="marvin.models.Movie.datetime_added">
<tt class="descname">datetime_added</tt><a class="headerlink" href="#marvin.models.Movie.datetime_added" title="Permalink to this definition">¶</a></dt>
<dd><p>Time added to database</p>
</dd></dl>

<dl class="attribute">
<dt id="marvin.models.Movie.external_id">
<tt class="descname">external_id</tt><a class="headerlink" href="#marvin.models.Movie.external_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Namespaced identification of some resource, like a movies ID om IMDb, or it&#8217;s ID on
YouTube/Vimeo, or just a URI if we don&#8217;t know the site already. Format like &#8220;imdb:tt01&#8221;
or &#8220;youtube:Fq00mCqBMY8&#8221;.</p>
</dd></dl>

<dl class="attribute">
<dt id="marvin.models.Movie.id">
<tt class="descname">id</tt><a class="headerlink" href="#marvin.models.Movie.id" title="Permalink to this definition">¶</a></dt>
<dd><p>Identifies the movie uniquely. Do not make assumptions about the nature of this field
as it might change without notice. Is completely unrelated to other IDs found elsewhere
for the same movie, like on IMDb or similar sites.</p>
</dd></dl>

<dl class="attribute">
<dt id="marvin.models.Movie.number_of_streams">
<tt class="descname">number_of_streams</tt><a class="headerlink" href="#marvin.models.Movie.number_of_streams" title="Permalink to this definition">¶</a></dt>
<dd><p>An aggregate of number of streams available</p>
</dd></dl>

<dl class="attribute">
<dt id="marvin.models.Movie.title">
<tt class="descname">title</tt><a class="headerlink" href="#marvin.models.Movie.title" title="Permalink to this definition">¶</a></dt>
<dd><p>The title of the movie. Note that this field is <em>not sufficient</em> to uniquely identify a
movie. Always use IDs if you need to do that.</p>
</dd></dl>

<dl class="method">
<dt id="marvin.models.Movie.to_json">
<tt class="descname">to_json</tt><big>(</big><em>include_streams=True</em><big>)</big><a class="headerlink" href="#marvin.models.Movie.to_json" title="Permalink to this definition">¶</a></dt>
<dd><p>A dict representation of the movie that can be used for serialization.</p>
</dd></dl>

<dl class="method">
<dt id="marvin.models.Movie.update_relevancy">
<tt class="descname">update_relevancy</tt><big>(</big><big>)</big><a class="headerlink" href="#marvin.models.Movie.update_relevancy" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate a new relevancy rating for the movie.</p>
<p>The IMDb rating is weighted the most, contributing a potential 200 points out of a 325 max,
while the metascore ranking can contribute another 100 points, 25 points for number of
votes, and then the score is discounted by a factor of .99 for each year since it&#8217;s relase.</p>
</dd></dl>

<dl class="attribute">
<dt id="marvin.models.Movie.year">
<tt class="descname">year</tt><a class="headerlink" href="#marvin.models.Movie.year" title="Permalink to this definition">¶</a></dt>
<dd><p>Year the movies was first shown</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="marvin.models.MovieForm">
<em class="property">class </em><tt class="descclassname">marvin.models.</tt><tt class="descname">MovieForm</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#marvin.models.MovieForm" title="Permalink to this definition">¶</a></dt>
<dd><p>The form used to validate new movie objects.</p>
</dd></dl>

<dl class="class">
<dt id="marvin.models.Stream">
<em class="property">class </em><tt class="descclassname">marvin.models.</tt><tt class="descname">Stream</tt><big>(</big><em>movie=None</em>, <em>creator=None</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#marvin.models.Stream" title="Permalink to this definition">¶</a></dt>
<dd><p>A collection of related, timecoded entries that accompanies a movie.</p>
<p>Entries in a stream will usually have some common theme, like annoucing new
actors that enter the screen, or providing references for topics mentioned
in a movie.</p>
<dl class="attribute">
<dt id="marvin.models.Stream.creator">
<tt class="descname">creator</tt><a class="headerlink" href="#marvin.models.Stream.creator" title="Permalink to this definition">¶</a></dt>
<dd><p>The user that created the stream</p>
</dd></dl>

<dl class="attribute">
<dt id="marvin.models.Stream.creator_id">
<tt class="descname">creator_id</tt><a class="headerlink" href="#marvin.models.Stream.creator_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Foreign key to the user that created the stream</p>
</dd></dl>

<dl class="attribute">
<dt id="marvin.models.Stream.description">
<tt class="descname">description</tt><a class="headerlink" href="#marvin.models.Stream.description" title="Permalink to this definition">¶</a></dt>
<dd><p>Short description of the stream</p>
</dd></dl>

<dl class="attribute">
<dt id="marvin.models.Stream.id">
<tt class="descname">id</tt><a class="headerlink" href="#marvin.models.Stream.id" title="Permalink to this definition">¶</a></dt>
<dd><p>Unique identifier for this stream. Do not make assumptions about it&#8217;s format, subject to change.</p>
</dd></dl>

<dl class="attribute">
<dt id="marvin.models.Stream.movie">
<tt class="descname">movie</tt><a class="headerlink" href="#marvin.models.Stream.movie" title="Permalink to this definition">¶</a></dt>
<dd><p>The movie this stream is associated to.</p>
</dd></dl>

<dl class="attribute">
<dt id="marvin.models.Stream.movie_id">
<tt class="descname">movie_id</tt><a class="headerlink" href="#marvin.models.Stream.movie_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Foreign key to a movie</p>
</dd></dl>

<dl class="attribute">
<dt id="marvin.models.Stream.name">
<tt class="descname">name</tt><a class="headerlink" href="#marvin.models.Stream.name" title="Permalink to this definition">¶</a></dt>
<dd><p>A user chosen name for the stream. Users can change this at their own discretion, do not assume to
be constant.</p>
</dd></dl>

<dl class="attribute">
<dt id="marvin.models.Stream.public">
<tt class="descname">public</tt><a class="headerlink" href="#marvin.models.Stream.public" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether the stream is visible public. Must be set explicitly to True by the user when he/she
considers the stream done.</p>
</dd></dl>

<dl class="method">
<dt id="marvin.models.Stream.to_json">
<tt class="descname">to_json</tt><big>(</big><em>include_movie=True</em><big>)</big><a class="headerlink" href="#marvin.models.Stream.to_json" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a dict representation of the stream suitable for serialization.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="marvin.models.StreamForm">
<em class="property">class </em><tt class="descclassname">marvin.models.</tt><tt class="descname">StreamForm</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#marvin.models.StreamForm" title="Permalink to this definition">¶</a></dt>
<dd><p>A form used to validate new streams.</p>
</dd></dl>

<dl class="class">
<dt id="marvin.models.User">
<em class="property">class </em><tt class="descclassname">marvin.models.</tt><tt class="descname">User</tt><big>(</big><em>**kwargs</em><big>)</big><a class="headerlink" href="#marvin.models.User" title="Permalink to this definition">¶</a></dt>
<dd><p>A user of the app.</p>
<dl class="attribute">
<dt id="marvin.models.User.email">
<tt class="descname">email</tt><a class="headerlink" href="#marvin.models.User.email" title="Permalink to this definition">¶</a></dt>
<dd><p>The user&#8217;s email address</p>
</dd></dl>

<dl class="method">
<dt id="marvin.models.User.get_auth_token">
<tt class="descname">get_auth_token</tt><big>(</big><big>)</big><a class="headerlink" href="#marvin.models.User.get_auth_token" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a auth token the user can use to authenticate agains the service.</p>
</dd></dl>

<dl class="attribute">
<dt id="marvin.models.User.id">
<tt class="descname">id</tt><a class="headerlink" href="#marvin.models.User.id" title="Permalink to this definition">¶</a></dt>
<dd><p>Unique identifier for this user</p>
</dd></dl>

<dl class="method">
<dt id="marvin.models.User.is_authenticated">
<tt class="descname">is_authenticated</tt><big>(</big><big>)</big><a class="headerlink" href="#marvin.models.User.is_authenticated" title="Permalink to this definition">¶</a></dt>
<dd><p>Used to tell the difference between authenticated users and anonymous users.</p>
</dd></dl>

<dl class="attribute">
<dt id="marvin.models.User.password_hash">
<tt class="descname">password_hash</tt><a class="headerlink" href="#marvin.models.User.password_hash" title="Permalink to this definition">¶</a></dt>
<dd><p>A string in the format method$salt$hash, where method for now will be scrypt:N:p:r,
with N, p and r can be chosen to be arbitrary strong on a given machine.</p>
</dd></dl>

<dl class="method">
<dt id="marvin.models.User.to_json">
<tt class="descname">to_json</tt><big>(</big><em>include_personal_data=False</em><big>)</big><a class="headerlink" href="#marvin.models.User.to_json" title="Permalink to this definition">¶</a></dt>
<dd><p>A dict representation of the user.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>include_personal_data</strong> &#8211; Whether to include sensitive data such as email.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="marvin.models.User.user_created_datetime">
<tt class="descname">user_created_datetime</tt><a class="headerlink" href="#marvin.models.User.user_created_datetime" title="Permalink to this definition">¶</a></dt>
<dd><p>Date and time of signup</p>
</dd></dl>

<dl class="attribute">
<dt id="marvin.models.User.username">
<tt class="descname">username</tt><a class="headerlink" href="#marvin.models.User.username" title="Permalink to this definition">¶</a></dt>
<dd><p>The users chosen username</p>
</dd></dl>

<dl class="method">
<dt id="marvin.models.User.verify_auth_data">
<tt class="descname">verify_auth_data</tt><big>(</big><em>auth_data</em><big>)</big><a class="headerlink" href="#marvin.models.User.verify_auth_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Verify that an auth_data is valid for this user.</p>
<p>In pracice this means checking that the password in the given data is still valid
and has not expired yet.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="marvin.models.UserForm">
<em class="property">class </em><tt class="descclassname">marvin.models.</tt><tt class="descname">UserForm</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#marvin.models.UserForm" title="Permalink to this definition">¶</a></dt>
<dd><p>Form used to validate new user creation.</p>
</dd></dl>

<dl class="class">
<dt id="marvin.models.UserLoginForm">
<em class="property">class </em><tt class="descclassname">marvin.models.</tt><tt class="descname">UserLoginForm</tt><big>(</big><em>formdata=&lt;class flask_wtf.form._Auto at 0x40f61f0&gt;</em>, <em>obj=None</em>, <em>prefix=''</em>, <em>csrf_context=None</em>, <em>secret_key=None</em>, <em>csrf_enabled=None</em>, <em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#marvin.models.UserLoginForm" title="Permalink to this definition">¶</a></dt>
<dd><p>Form used to validate user logins.</p>
</dd></dl>

</div>
<span class="target" id="module-marvin.permissions"></span><div class="section" id="marvin-permissions">
<h2>marvin.permissions<a class="headerlink" href="#marvin-permissions" title="Permalink to this headline">¶</a></h2>
<p>Permissions used around marvin.</p>
<dl class="function">
<dt id="marvin.permissions.login_required">
<tt class="descclassname">marvin.permissions.</tt><tt class="descname">login_required</tt><big>(</big><em>func</em><big>)</big><a class="headerlink" href="#marvin.permissions.login_required" title="Permalink to this definition">¶</a></dt>
<dd><p>If you decorate a view with this, it will ensure that the current user is
logged in and authenticated before calling the actual view.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>func</strong> (<em>function</em>) &#8211; The view function to decorate.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="marvin.permissions.on_identity_loaded">
<tt class="descclassname">marvin.permissions.</tt><tt class="descname">on_identity_loaded</tt><big>(</big><em>sender</em>, <em>identity</em><big>)</big><a class="headerlink" href="#marvin.permissions.on_identity_loaded" title="Permalink to this definition">¶</a></dt>
<dd><p>When an identify is loaded, initialize it with it&#8217;s permissions.</p>
</dd></dl>

</div>
<span class="target" id="module-marvin.security"></span><div class="section" id="marvin-security">
<h2>marvin.security<a class="headerlink" href="#marvin-security" title="Permalink to this headline">¶</a></h2>
<p>Security-related utilities and tools.</p>
<dl class="function">
<dt id="marvin.security.before_request_authentication">
<tt class="descclassname">marvin.security.</tt><tt class="descname">before_request_authentication</tt><big>(</big><big>)</big><a class="headerlink" href="#marvin.security.before_request_authentication" title="Permalink to this definition">¶</a></dt>
<dd><p>Connect with &#64;app.before_request to authenticate users using the
<cite>auth_token</cite> request param.</p>
<p>Assigns a user to <cite>g.user</cite>, AnonymousUser if no auth_token was sent in the request.</p>
</dd></dl>

<dl class="function">
<dt id="marvin.security.decode_token_or_400">
<tt class="descclassname">marvin.security.</tt><tt class="descname">decode_token_or_400</tt><big>(</big><em>auth_token</em><big>)</big><a class="headerlink" href="#marvin.security.decode_token_or_400" title="Permalink to this definition">¶</a></dt>
<dd><p>Decode the given auth_token and return the data dict therein, or fail with a HTTP 400 error.</p>
</dd></dl>

<dl class="function">
<dt id="marvin.security.force_bytes">
<tt class="descclassname">marvin.security.</tt><tt class="descname">force_bytes</tt><big>(</big><em>string</em><big>)</big><a class="headerlink" href="#marvin.security.force_bytes" title="Permalink to this definition">¶</a></dt>
<dd><p>Make sure the given argument is an instance of bytes. On python3, this is probably the case,
but on python2 we have to encode it with an encoding, in this case we&#8217;ll use utf-8.</p>
</dd></dl>

<dl class="function">
<dt id="marvin.security.generate_pw_hash">
<tt class="descclassname">marvin.security.</tt><tt class="descname">generate_pw_hash</tt><big>(</big><em>password</em><big>)</big><a class="headerlink" href="#marvin.security.generate_pw_hash" title="Permalink to this definition">¶</a></dt>
<dd><p>Hash the given password.</p>
<p>Return a string in the format <tt class="docutils literal"><span class="pre">method$salt$hash</span></tt>.</p>
</dd></dl>

<dl class="function">
<dt id="marvin.security.get_auth_token_from_header">
<tt class="descclassname">marvin.security.</tt><tt class="descname">get_auth_token_from_header</tt><big>(</big><big>)</big><a class="headerlink" href="#marvin.security.get_auth_token_from_header" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract the token from a HTTP Authorization header.</p>
<p>The header is supposed to look be in the format <cite>Authorization: Token &lt;access token&gt;</cite></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Auth token from header, or <cite>None</cite> if none was found.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="marvin.security.get_system_scrypt_params">
<tt class="descclassname">marvin.security.</tt><tt class="descname">get_system_scrypt_params</tt><big>(</big><big>)</big><a class="headerlink" href="#marvin.security.get_system_scrypt_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Get optimal N, p and r values for this sytem.</p>
</dd></dl>

<dl class="function">
<dt id="marvin.security.get_user_from_auth_data">
<tt class="descclassname">marvin.security.</tt><tt class="descname">get_user_from_auth_data</tt><big>(</big><em>auth_data</em><big>)</big><a class="headerlink" href="#marvin.security.get_user_from_auth_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the user object from the given auth_data. Raises HTTP 401 if token is no longer valid or user doesn&#8217;t exist
anymore.</p>
</dd></dl>

<dl class="function">
<dt id="marvin.security.is_correct_pw">
<tt class="descclassname">marvin.security.</tt><tt class="descname">is_correct_pw</tt><big>(</big><em>password</em>, <em>password_hash</em><big>)</big><a class="headerlink" href="#marvin.security.is_correct_pw" title="Permalink to this definition">¶</a></dt>
<dd><p>Check that the given password hashes to the given password_hash.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>password</strong> &#8211; The password to test</li>
<li><strong>password_hash</strong> &#8211; A method$salt$hash string we can extract the method and params used in the
original hashing from.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<span class="target" id="module-marvin.utils"></span><div class="section" id="marvin-utils">
<h2>marvin.utils<a class="headerlink" href="#marvin-utils" title="Permalink to this headline">¶</a></h2>
<p>A collection of utilities that might be handy in several places in the marvin code.</p>
<dl class="class">
<dt id="marvin.utils.ApiBase">
<em class="property">class </em><tt class="descclassname">marvin.utils.</tt><tt class="descname">ApiBase</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#marvin.utils.ApiBase" title="Permalink to this definition">¶</a></dt>
<dd><p>Base API class used to add some extra functionality to Flask-RESTful.</p>
<dl class="method">
<dt id="marvin.utils.ApiBase.handle_error">
<tt class="descname">handle_error</tt><big>(</big><em>exception</em><big>)</big><a class="headerlink" href="#marvin.utils.ApiBase.handle_error" title="Permalink to this definition">¶</a></dt>
<dd><p>Override handle_error to make sure the exception is handled by the correct logger.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="marvin.utils.error_handler">
<tt class="descclassname">marvin.utils.</tt><tt class="descname">error_handler</tt><big>(</big><em>error</em><big>)</big><a class="headerlink" href="#marvin.utils.error_handler" title="Permalink to this definition">¶</a></dt>
<dd><p>Handles errors outside the API, ie in blueprints.</p>
</dd></dl>

<dl class="function">
<dt id="marvin.utils.generic_error_handler">
<tt class="descclassname">marvin.utils.</tt><tt class="descname">generic_error_handler</tt><big>(</big><em>exception</em><big>)</big><a class="headerlink" href="#marvin.utils.generic_error_handler" title="Permalink to this definition">¶</a></dt>
<dd><p>Log exception to the standard marvin logger.</p>
</dd></dl>

</div>
<span class="target" id="module-marvin.views"></span><div class="section" id="marvin-views">
<h2>marvin.views<a class="headerlink" href="#marvin-views" title="Permalink to this headline">¶</a></h2>
<p>All views registered on marvin. All views registered must also be
registered to the app object in <tt class="xref py py-func docutils literal"><span class="pre">create_app()</span></tt>.</p>
</div>
<span class="target" id="module-marvin.views.entries"></span><div class="section" id="marvin-views-entries">
<h2>marvin.views.entries<a class="headerlink" href="#marvin-views-entries" title="Permalink to this headline">¶</a></h2>
<p>CRUD endpoints for stream entries.</p>
<dl class="class">
<dt id="marvin.views.entries.CreateEntryView">
<em class="property">class </em><tt class="descclassname">marvin.views.entries.</tt><tt class="descname">CreateEntryView</tt><a class="headerlink" href="#marvin.views.entries.CreateEntryView" title="Permalink to this definition">¶</a></dt>
<dd><p>Create interface to entries.</p>
<dl class="method">
<dt id="marvin.views.entries.CreateEntryView.post">
<tt class="descname">post</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#marvin.views.entries.CreateEntryView.post" title="Permalink to this definition">¶</a></dt>
<dd><p>Create new entry.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="marvin.views.entries.EntryDetailView">
<em class="property">class </em><tt class="descclassname">marvin.views.entries.</tt><tt class="descname">EntryDetailView</tt><a class="headerlink" href="#marvin.views.entries.EntryDetailView" title="Permalink to this definition">¶</a></dt>
<dd><p>RUD interface to entries.</p>
<dl class="method">
<dt id="marvin.views.entries.EntryDetailView.delete">
<tt class="descname">delete</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#marvin.views.entries.EntryDetailView.delete" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete the entry with the given ID.</p>
</dd></dl>

<dl class="method">
<dt id="marvin.views.entries.EntryDetailView.get">
<tt class="descname">get</tt><big>(</big><em>entry_id</em><big>)</big><a class="headerlink" href="#marvin.views.entries.EntryDetailView.get" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the entry with the given ID.</p>
</dd></dl>

<dl class="method">
<dt id="marvin.views.entries.EntryDetailView.put">
<tt class="descname">put</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#marvin.views.entries.EntryDetailView.put" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the entry with the given ID.</p>
</dd></dl>

</dd></dl>

</div>
<span class="target" id="module-marvin.views.movies"></span><div class="section" id="marvin-views-movies">
<h2>marvin.views.movies<a class="headerlink" href="#marvin-views-movies" title="Permalink to this headline">¶</a></h2>
<p>Endpoints related to movies.</p>
<dl class="class">
<dt id="marvin.views.movies.AllMoviesView">
<em class="property">class </em><tt class="descclassname">marvin.views.movies.</tt><tt class="descname">AllMoviesView</tt><a class="headerlink" href="#marvin.views.movies.AllMoviesView" title="Permalink to this definition">¶</a></dt>
<dd><p>R interface to all movies.</p>
<p>Creation is in general not done manually by users, but rather automatically through search
results and the likes. Only case where you can explicitly create a movie is by entering a url,
so that we can look up the necessary parameters ourselves. This will be implemented later.</p>
<dl class="method">
<dt id="marvin.views.movies.AllMoviesView.get">
<tt class="descname">get</tt><big>(</big><big>)</big><a class="headerlink" href="#marvin.views.movies.AllMoviesView.get" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a list of id -&gt; movie title pairs of all movies registered.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="marvin.views.movies.MovieDetailView">
<em class="property">class </em><tt class="descclassname">marvin.views.movies.</tt><tt class="descname">MovieDetailView</tt><a class="headerlink" href="#marvin.views.movies.MovieDetailView" title="Permalink to this definition">¶</a></dt>
<dd><p>Read interface to movies.</p>
<dl class="method">
<dt id="marvin.views.movies.MovieDetailView.get">
<tt class="descname">get</tt><big>(</big><em>movie_id</em><big>)</big><a class="headerlink" href="#marvin.views.movies.MovieDetailView.get" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the movie with the given ID.</p>
</dd></dl>

</dd></dl>

</div>
<span class="target" id="module-marvin.views.stats"></span><div class="section" id="marvin-views-stats">
<h2>marvin.views.stats<a class="headerlink" href="#marvin-views-stats" title="Permalink to this headline">¶</a></h2>
<p>Show some key numbers about the current marvin database.</p>
<dl class="function">
<dt id="marvin.views.stats.stats_main">
<tt class="descclassname">marvin.views.stats.</tt><tt class="descname">stats_main</tt><big>(</big><big>)</big><a class="headerlink" href="#marvin.views.stats.stats_main" title="Permalink to this definition">¶</a></dt>
<dd><p>Show some key numbers.</p>
</dd></dl>

</div>
<span class="target" id="module-marvin.views.streams"></span><div class="section" id="marvin-views-streams">
<h2>marvin.views.streams<a class="headerlink" href="#marvin-views-streams" title="Permalink to this headline">¶</a></h2>
<p>CRUD endpoints for streams.</p>
<dl class="class">
<dt id="marvin.views.streams.CreateStreamView">
<em class="property">class </em><tt class="descclassname">marvin.views.streams.</tt><tt class="descname">CreateStreamView</tt><a class="headerlink" href="#marvin.views.streams.CreateStreamView" title="Permalink to this definition">¶</a></dt>
<dd><p>Create interface for streams.</p>
<dl class="method">
<dt id="marvin.views.streams.CreateStreamView.post">
<tt class="descname">post</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#marvin.views.streams.CreateStreamView.post" title="Permalink to this definition">¶</a></dt>
<dd><p>Create new stream.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="marvin.views.streams.PublishStreamView">
<em class="property">class </em><tt class="descclassname">marvin.views.streams.</tt><tt class="descname">PublishStreamView</tt><a class="headerlink" href="#marvin.views.streams.PublishStreamView" title="Permalink to this definition">¶</a></dt>
<dd><p>Publish the given stream.</p>
<dl class="method">
<dt id="marvin.views.streams.PublishStreamView.post">
<tt class="descname">post</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#marvin.views.streams.PublishStreamView.post" title="Permalink to this definition">¶</a></dt>
<dd><p>Publish the stream, increase movie&#8217;s stream count.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="marvin.views.streams.StreamDetailView">
<em class="property">class </em><tt class="descclassname">marvin.views.streams.</tt><tt class="descname">StreamDetailView</tt><a class="headerlink" href="#marvin.views.streams.StreamDetailView" title="Permalink to this definition">¶</a></dt>
<dd><p>RUD interface to streams.</p>
<dl class="method">
<dt id="marvin.views.streams.StreamDetailView.delete">
<tt class="descname">delete</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#marvin.views.streams.StreamDetailView.delete" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete the stream with the given ID.</p>
</dd></dl>

<dl class="method">
<dt id="marvin.views.streams.StreamDetailView.get">
<tt class="descname">get</tt><big>(</big><em>stream_id</em><big>)</big><a class="headerlink" href="#marvin.views.streams.StreamDetailView.get" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the stream with the given ID.</p>
</dd></dl>

<dl class="method">
<dt id="marvin.views.streams.StreamDetailView.put">
<tt class="descname">put</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#marvin.views.streams.StreamDetailView.put" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the stream with the given ID.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="marvin.views.streams.StreamEntryView">
<em class="property">class </em><tt class="descclassname">marvin.views.streams.</tt><tt class="descname">StreamEntryView</tt><a class="headerlink" href="#marvin.views.streams.StreamEntryView" title="Permalink to this definition">¶</a></dt>
<dd><p>Read endpoint for entries in a stream.</p>
<dl class="method">
<dt id="marvin.views.streams.StreamEntryView.get">
<tt class="descname">get</tt><big>(</big><em>stream_id</em><big>)</big><a class="headerlink" href="#marvin.views.streams.StreamEntryView.get" title="Permalink to this definition">¶</a></dt>
<dd><p>Get entries for the given stream.</p>
<p>Respect the following request parameters:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">limit</span></tt>: Restrict number of entries returned to this amount.</li>
<li><tt class="docutils literal"><span class="pre">starttime_gt</span></tt>: Only return entries that enter after this time, in ms.</li>
</ul>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="marvin.views.streams.UnpublishStreamView">
<em class="property">class </em><tt class="descclassname">marvin.views.streams.</tt><tt class="descname">UnpublishStreamView</tt><a class="headerlink" href="#marvin.views.streams.UnpublishStreamView" title="Permalink to this definition">¶</a></dt>
<dd><p>Unpublish the given stream.</p>
<dl class="method">
<dt id="marvin.views.streams.UnpublishStreamView.post">
<tt class="descname">post</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#marvin.views.streams.UnpublishStreamView.post" title="Permalink to this definition">¶</a></dt>
<dd><p>Unpublish the stream, decrease movie&#8217;s stream count.</p>
</dd></dl>

</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">API documentation</a><ul>
<li><a class="reference internal" href="#marvin">marvin</a></li>
<li><a class="reference internal" href="#marvin-fields">marvin.fields</a></li>
<li><a class="reference internal" href="#marvin-management">marvin.management</a></li>
<li><a class="reference internal" href="#marvin-models">marvin.models</a></li>
<li><a class="reference internal" href="#marvin-permissions">marvin.permissions</a></li>
<li><a class="reference internal" href="#marvin-security">marvin.security</a></li>
<li><a class="reference internal" href="#marvin-utils">marvin.utils</a></li>
<li><a class="reference internal" href="#marvin-views">marvin.views</a></li>
<li><a class="reference internal" href="#marvin-views-entries">marvin.views.entries</a></li>
<li><a class="reference internal" href="#marvin-views-movies">marvin.views.movies</a></li>
<li><a class="reference internal" href="#marvin-views-stats">marvin.views.stats</a></li>
<li><a class="reference internal" href="#marvin-views-streams">marvin.views.streams</a></li>
</ul>
</li>
</ul>
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="api.html" title="previous chapter">External API</a></li>
  </ul></li>
</ul>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/internal_api.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
  <div class="footer">
    &copy; Copyright 2013, Tarjei Husøy.
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a>.
  </div>
  
  </body>
</html>